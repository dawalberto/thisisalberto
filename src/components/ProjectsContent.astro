---
import { getCollection } from 'astro:content';
import { useTranslations } from '../i18n/utils';
import Layout from '../layouts/Layout.astro';
import ProjectCard from './ProjectCard.astro';
import SEOSchema from './SEOSchema.astro';

interface Props {
  lang: 'en' | 'es';
}

const { lang } = Astro.props;
const t = useTranslations(lang);
const projects = (await getCollection('projects', ({ id }) => id.startsWith(`${lang}/`)))
    .sort((a, b) => a.data.order - b.data.order);

const description = lang === 'es'
    ? 'Descubre los proyectos personales de Alberto García Sola. Aplicaciones web desarrolladas con React, TypeScript, Astro y tecnologías modernas.'
    : 'Discover Alberto García Sola\'s personal projects. Web applications built with React, TypeScript, Astro, and modern technologies.';

const keywords = lang === 'es'
    ? 'proyectos web, portfolio proyectos, React projects, TypeScript, desarrollo web, aplicaciones web'
    : 'web projects, portfolio projects, React projects, TypeScript, web development, web applications';
---

<Layout 
    title={t('projects.pageTitle')} 
    description={description}
    keywords={keywords}
    lang={lang}
>
    <SEOSchema type="WebPage" lang={lang} slot="schema" />
    <div class="container mx-auto px-3 sm:px-4 pb-8 sm:pb-12 md:pb-20">
        <h1 class="text-2xl sm:text-3xl md:text-4xl lg:text-5xl font-bold font-heading text-slate-900 mb-8 sm:mb-12 md:mb-16 animate-fade-in-down uppercase tracking-tighter leading-tight">
            {t('projects.title.prefix')} 
            <span class="relative inline-block">
                {t('projects.title.highlight')}
                <span class="absolute bottom-1 sm:bottom-2 left-0 w-full h-2 sm:h-3 bg-accent -z-10 -rotate-2"></span>
            </span>
        </h1>
        <div class="flex flex-col animate-fade-in-up">
            {projects.map((project, index) => (
                <ProjectCard project={project} lang={lang} index={index} />
            ))}
        </div>
    </div>
</Layout>

<style>
    .animate-fade-in-down {
        animation: fadeInDown 0.6s ease-out;
    }
    .animate-fade-in-up {
        animation: fadeInUp 0.8s ease-out;
    }
    @keyframes fadeInDown {
        from { opacity: 0; transform: translateY(-20px); }
        to { opacity: 1; transform: translateY(0); }
    }
    @keyframes fadeInUp {
        from { opacity: 0; transform: translateY(20px); }
        to { opacity: 1; transform: translateY(0); }
    }
</style>
